# 另外一个版本的personal_detail,这个更简单
## search key
```
50 ???? ?? ???? ?? ???????? ???? ???????? 8d?? ?? ???? ?? ?? 8d?? ???????? 50 8b?? e8 ????????
```
## parameter
eax = wxid structure
ebx = [wechatwin.dll+0x1A8818C]+0x28+0x8c    //3.2.1.121偏移===ce  contact header_node  = value
感觉这个ebx是数据库的句柄
[和获取内存用户的偏移一样]
## key call
```
7877367A     | 50                | push eax                        | 【3.2.1.121】此处是contact detail另外一个call ,更简单
7877367B     | 8BCB              | mov ecx,ebx                     |
7877367D     | E8 4E7CBDFF       | call wechatwin.7834B2D0         |
```
## asm code
```
78773620     | 55                | push ebp                        |
78773621     | 8BEC              | mov ebp,esp                     |
78773623     | 6A FF             | push FFFFFFFF                   |
78773625     | 68 70187379       | push wechatwin.79731870         |
7877362A     | 64:A1 00000000    | mov eax,dword ptr fs:[0]        |
78773630     | 50                | push eax                        |
78773631     | 83EC 0C           | sub esp,C                       |
78773634     | 53                | push ebx                        |
78773635     | 56                | push esi                        | esi:" \n\x02"
78773636     | A1 945BC679       | mov eax,dword ptr ds:[79C65B94] |
7877363B     | 33C5              | xor eax,ebp                     |
7877363D     | 50                | push eax                        |
7877363E     | 8D45 F4           | lea eax,dword ptr ss:[ebp-C]    |
78773641     | 64:A3 00000000    | mov dword ptr fs:[0],eax        |
78773647     | 8BF1              | mov esi,ecx                     | esi:" \n\x02"
78773649     | 8B45 08           | mov eax,dword ptr ss:[ebp+8]    | [ebp+8]:" \n\x02"
7877364C     | 8945 F0           | mov dword ptr ss:[ebp-10],eax   |
7877364F     | 8D86 BC000000     | lea eax,dword ptr ds:[esi+BC]   | esi+BC:L"default\\theme_default.xml"
78773655     | C745 FC 00000000  | mov dword ptr ss:[ebp-4],0      |
7877365C     | 50                | push eax                        |
7877365D     | 8945 E8           | mov dword ptr ss:[ebp-18],eax   |
78773660     | C745 EC 00000000  | mov dword ptr ss:[ebp-14],0     |
78773667     | FF15 60A27E79     | call dword ptr ds:[<&RtlEnterCr |
7877366D     | 8D45 0C           | lea eax,dword ptr ss:[ebp+C]    |
78773670     | C645 FC 01        | mov byte ptr ss:[ebp-4],1       |
78773674     | 8D9E 8C000000     | lea ebx,dword ptr ds:[esi+8C]   | 【此处是contact header地址】
7877367A     | 50                | push eax                        | 【3.2.1.121】此处是contact detail另外一个call ,更简单
7877367B     | 8BCB              | mov ecx,ebx                     |
7877367D     | E8 4E7CBDFF       | call wechatwin.7834B2D0         |  [call]
78773682     | 8BF0              | mov esi,eax                     | esi:" \n\x02"
78773684     | 3B33              | cmp esi,dword ptr ds:[ebx]      | esi:" \n\x02"
78773686     | 74 13             | je wechatwin.7877369B           |
78773688     | 8D46 10           | lea eax,dword ptr ds:[esi+10]   |
7877368B     | 8BCB              | mov ecx,ebx                     |
7877368D     | 50                | push eax                        |
7877368E     | 8D45 0C           | lea eax,dword ptr ss:[ebp+C]    |
78773691     | 50                | push eax                        |
78773692     | E8 4970BDFF       | call wechatwin.7834A6E0         |
78773697     | 84C0              | test al,al                      |
78773699     | 74 02             | je wechatwin.7877369D           |
7877369B     | 8B33              | mov esi,dword ptr ds:[ebx]      | esi:" \n\x02"
7877369D     | 3B33              | cmp esi,dword ptr ds:[ebx]      | esi:" \n\x02"
7877369F     | 74 10             | je wechatwin.787736B1           |
787736A1     | 8B4D F0           | mov ecx,dword ptr ss:[ebp-10]   |
787736A4     | 83C6 28           | add esi,28                      | esi:" \n\x02"
787736A7     | 56                | push esi                        | esi:" \n\x02"
787736A8     | E8 E30BB4FF       | call wechatwin.782B4290         |
787736AD     | B3 01             | mov bl,1                        |
787736AF     | EB 02             | jmp wechatwin.787736B3          |
787736B1     | 32DB              | xor bl,bl                       |
787736B3     | FF75 E8           | push dword ptr ss:[ebp-18]      |
787736B6     | FF15 5CA27E79     | call dword ptr ds:[<&RtlLeaveCr |
787736BC     | 8B4D 20           | mov ecx,dword ptr ss:[ebp+20]   |
787736BF     | 83F9 10           | cmp ecx,10                      |
787736C2     | 72 0F             | jb wechatwin.787736D3           |
787736C4     | 6A 01             | push 1                          |
787736C6     | 41                | inc ecx                         |
787736C7     | 51                | push ecx                        |
787736C8     | FF75 0C           | push dword ptr ss:[ebp+C]       |
787736CB     | E8 700EB3FF       | call wechatwin.782A4540         |
787736D0     | 83C4 0C           | add esp,C                       |
787736D3     | 8AC3              | mov al,bl                       |
787736D5     | 8B4D F4           | mov ecx,dword ptr ss:[ebp-C]    |
787736D8     | 64:890D 00000000  | mov dword ptr fs:[0],ecx        |
787736DF     | 59                | pop ecx                         |
787736E0     | 5E                | pop esi                         | esi:" \n\x02"
787736E1     | 5B                | pop ebx                         |
787736E2     | 8BE5              | mov esp,ebp                     |
787736E4     | 5D                | pop ebp                         |
787736E5     | C2 1C00           | ret 1C                          |
```

```
$ ==>     1555D1B0  °ÑU.  
$+4       154548F0  ðHE.  
$+8       15410838  8.A.  
$+C       00000001  ....  
$+10      153A8D18  ..:.  "wxid_nqsqzoui6lse22"
$+14      00000000  ....  
$+18      00000000  ....  
$+1C      00000000  ....  
$+20      00000013  ....  
$+24      0000001F  ....  
$+28      00000000  ....  
$+2C      00000000  ....  
$+30      153EDDA8  ¨Ý>.  L"wxid_nqsqzoui6lse22"
$+34      00000013  ....  
$+38      00000013  ....  
$+3C      00000000  ....  
$+40      00000000  ....  
$+44      00000000  ....  
$+48      00000000  ....  
$+4C      00000000  ....  
$+50      00000000  ....  
$+54      00000000  ....  
$+58      15328098  ..2.  L"v3_020b3826fd03010000000000abf6348737ae48000000501ea9a3dba12f95f6b60a0536a1adb669be98b2249577eb5583c47689662760007b7a074f45e9fd6122a1a9d3a00179d3665479b6bf96c4291f25108982e1f8b62e7b90d0681df1d26613e1@stranger"
$+5C      000000D0  Ð...  
$+60      000000D0  Ð...  
$+64      00000000  ....  
$+68      00000000  ....  
$+6C      00000000  ....  
$+70      00008103  ....  
$+74      00000000  ....  
$+78      00000000  ....  
$+7C      00000000  ....  
$+80      00000000  ....  
$+84      00000000  ....  
$+88      00000000  ....  
$+8C      153AB888  .¸:.  "蜹@T蜹@T"
$+90      00000004  ....  
$+94      00000004  ....  
$+98      00000000  ....  
$+9C      00000000  ....  
$+A0      00000000  ....  
$+A4      00000000  ....  
$+A8      00000000  ....  
$+AC      00000000  ....  
$+B0      00000000  ....  
$+B4      00000000  ....  
$+B8      00000000  ....  
$+BC      00000000  ....  
$+C0      00000000  ....  
$+C4      00000000  ....  
$+C8      00000001  ....  
$+CC      153AB900  .¹:.  L"AYAY"
$+D0      00000004  ....  
$+D4      00000004  ....  
$+D8      00000000  ....  
$+DC      00000000  ....  
$+E0      153B0990  ..;.  L"aiyaaiya"
$+E4      00000008  ....  
$+E8      00000008  ....  
$+EC      00000000  ....  
$+F0      00000000  ....  
$+F4      00000000  ....  
$+F8      00000000  ....  
$+FC      00000000  ....  
$+100     00000000  ....  
$+104     00000000  ....  
$+108     00000000  ....  
$+10C     00000000  ....  
$+110     00000000  ....  
$+114     00000000  ....  
$+118     00000000  ....  
$+11C     2C524490  .DR,  L"http://wx.qlogo.cn/mmhead/ver_1/FiaY3WnBdicobDYzj4F76HeUWw6OCcKTICWHPZfNbvPoGgPnHCzMbJ5gbicf2c0aqmzbOaHYDB7zZhBqon0BRNkAicyLRkkmHpiazUJvv5Ticjzto/0"
$+120     00000093  ....  
$+124     00000093  ....  
$+128     00000000  ....  
$+12C     00000000  ....  
$+130     2C5251F8  øQR,  L"http://wx.qlogo.cn/mmhead/ver_1/FiaY3WnBdicobDYzj4F76HeUWw6OCcKTICWHPZfNbvPoGgPnHCzMbJ5gbicf2c0aqmzbOaHYDB7zZhBqon0BRNkAicyLRkkmHpiazUJvv5Ticjzto/132"
$+134     00000095  ....  
$+138     00000095  ....  
$+13C     00000000  ....  
$+140     00000000  ....  
$+144     19304518  .E0.  "d859d2f9e473ca0eafdf5392581c02b6"
$+148     00000000  ....  
$+14C     00000000  ....  
$+150     00000000  ....  
$+154     00000020   ...  
$+158     0000002F  /...  
$+15C     00000000  ....  
$+160     00000000  ....  
$+164     00000001  ....  
$+168     00000001  ....  
$+16C     00000000  ....  
$+170     15411BB0  °.A.  
$+174     000002A7  §...  
$+178     00000000  ....  
$+17C     00000000  ....  
$+180     00000003  ....  
$+184     00000002  ....  
$+188     00000000  ....  
$+18C     00000000  ....  
$+190     00000000  ....  
$+194     00000000  ....  
$+198     00000000  ....  
$+19C     00000000  ....  
$+1A0     00000000  ....  
$+1A4     00000000  ....  
$+1A8     00000000  ....  
$+1AC     00000000  ....  
$+1B0     00000000  ....  
$+1B4     00000000  ....  
$+1B8     00000001  ....  
$+1BC     2C676748  Hgg,  L"这个世界什么都有，就是没有如果"
$+1C0     0000000F  ....  
$+1C4     0000000F  ....  
$+1C8     00000000  ....  
$+1CC     00000000  ....  
$+1D0     2576CA38  8Êv%  
$+1D4     00000002  ....  
$+1D8     00000002  ....  
$+1DC     00000000  ....  
$+1E0     00000000  ....  
$+1E4     00000000  ....  
$+1E8     00000000  ....  
$+1EC     00000000  ....  
$+1F0     00000000  ....  
$+1F4     00000000  ....  
$+1F8     00000000  ....  
$+1FC     00000000  ....  
$+200     00000000  ....  
$+204     00000000  ....  
$+208     00000000  ....  
$+20C     0000000F  ....  
$+210     00000000  ....  
$+214     00000000  ....  
$+218     00000000  ....  
$+21C     00000000  ....  
$+220     00000000  ....  
$+224     00000000  ....  
$+228     00000000  ....  
$+22C     00000000  ....  
$+230     00000000  ....  
$+234     00000000  ....  
$+238     00000000  ....  
$+23C     00000000  ....  
$+240     00000000  ....  
$+244     00000000  ....  
$+248     00000000  ....  
$+24C     FFFFFFFF  ÿÿÿÿ  
$+250     00008103  ....  
$+254     00000000  ....  
$+258     00000001  ....  
$+25C     00000000  ....  
$+260     00000000  ....  
$+264     00000000  ....  
$+268     00000000  ....  
$+26C     00000000  ....  
$+270     00000000  ....  
$+274     00000000  ....  
$+278     00000000  ....  
$+27C     00000000  ....  
$+280     00000000  ....  
$+284     00000000  ....  
$+288     00000000  ....  
$+28C     00000000  ....  
$+290     00000001  ....  
$+294     00000000  ....  
$+298     00000001  ....  
$+29C     2140AD00  ..@!  L"http://mmsns.qpic.cn/mmsns/4376ae1e0cf0ccced233def9ad1560d0dec29d64941ab85a30d36e9d20551e73d134f94732dc674092655741238a060bb20928f661ef59cc/0"
$+2A0     0000008D  ....  
$+2A4     0000008D  ....  
$+2A8     00000000  ....  
$+2AC     00000000  ....  
$+2B0     CC6C30BE  ¾0lÌ  
$+2B4     B3F4EEE0  àîô³  
$+2B8     00001A81  ....  
$+2BC     00000000  ....  
$+2C0     00000000  ....  
$+2C4     00000000  ....  
$+2C8     00000000  ....  
$+2CC     00000000  ....  
$+2D0     00000000  ....  
$+2D4     00000000  ....  
$+2D8     00000000  ....  
$+2DC     00000000  ....  
$+2E0     00000000  ....  
$+2E4     00000000  ....  
$+2E8     00000000  ....  
$+2EC     00000000  ....  
$+2F0     00000000  ....  
$+2F4     00000000  ....  
$+2F8     00000000  ....  
$+2FC     00000000  ....  
$+300     00000000  ....  
$+304     00000000  ....  
$+308     00000000  ....  
$+30C     00000000  ....  
$+310     00000000  ....  
$+314     00000000  ....  
$+318     00000000  ....  
$+31C     00000000  ....  
$+320     00000000  ....  
$+324     00000000  ....  
$+328     00000000  ....  
$+32C     00000000  ....  
$+330     00000000  ....  
$+334     00000000  ....  
$+338     00000000  ....  
$+33C     00000000  ....  
$+340     00000000  ....  
$+344     00000000  ....  
$+348     00000000  ....  
$+34C     2576CB08  .Ëv%  
$+350     00000002  ....  
$+354     00000000  ....  
$+358     00000000  ....  
$+35C     00000000  ....  
$+360     00000000  ....  
$+364     00000000  ....  
$+368     00000000  ....  
$+36C     00000000  ....  
$+370     00000000  ....  
$+374     00000000  ....  
$+378     00000000  ....  
$+37C     00000000  ....  
$+380     00000000  ....  
$+384     00000000  ....  
$+388     00000000  ....  
$+38C     00000000  ....  
$+390     00000000  ....  
$+394     00000000  ....  
$+398     00000000  ....  
$+39C     00000000  ....  
$+3A0     00000000  ....  
$+3A4     00000000  ....  
$+3A8     00000000  ....  
$+3AC     00000000  ....  
$+3B0     00000000  ....  
$+3B4     00000000  ....  
$+3B8     00000000  ....  
$+3BC     00000000  ....  
$+3C0     00000000  ....  
$+3C4     00000000  ....  
$+3C8     00000000  ....  
$+3CC     00000000  ....  
$+3D0     00000000  ....  
$+3D4     00000000  ....  
$+3D8     00000000  ....  
$+3DC     00000000  ....  
$+3E0     00000000  ....  
$+3E4     00000000  ....  
$+3E8     00000000  ....  
$+3EC     00000000  ....  
$+3F0     00000000  ....  
$+3F4     00000000  ....  
$+3F8     00000000  ....  
$+3FC     00000000  ....  
$+400     00000000  ....  
$+404     00000000  ....  
$+408     00000000  ....  
$+40C     00000000  ....  
$+410     00000000  ....  
$+414     00000000  ....  
$+418     00000000  ....  
$+41C     00000000  ....  
$+420     00000000  ....  
$+424     00000000  ....  
$+428     00000000  ....  
$+42C     00000000  ....  
$+430     00000000  ....  
$+434     00000000  ....  
$+438     00000000  ....  

```